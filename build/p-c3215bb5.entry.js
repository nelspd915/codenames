import{r as t,h as s,H as e}from"./p-5401066b.js";import{C as i,a as n}from"./p-9f42e523.js";const r=Object.create(null);r["open"]="0";r["close"]="1";r["ping"]="2";r["pong"]="3";r["message"]="4";r["upgrade"]="5";r["noop"]="6";const o=Object.create(null);Object.keys(r).forEach((t=>{o[r[t]]=t}));const h={type:"error",data:"parser error"};const c=typeof Blob==="function"||typeof Blob!=="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]";const f=typeof ArrayBuffer==="function";const a=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer;const u=({type:t,data:s},e,i)=>{if(c&&s instanceof Blob){if(e){return i(s)}else{return l(s,i)}}else if(f&&(s instanceof ArrayBuffer||a(s))){if(e){return i(s)}else{return l(new Blob([s]),i)}}return i(r[t]+(s||""))};const l=(t,s)=>{const e=new FileReader;e.onload=function(){const t=e.result.split(",")[1];s("b"+t)};return e.readAsDataURL(t)};const d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const p=typeof Uint8Array==="undefined"?[]:new Uint8Array(256);for(let t=0;t<d.length;t++){p[d.charCodeAt(t)]=t}const y=t=>{let s=t.length*.75,e=t.length,i,n=0,r,o,h,c;if(t[t.length-1]==="="){s--;if(t[t.length-2]==="="){s--}}const f=new ArrayBuffer(s),a=new Uint8Array(f);for(i=0;i<e;i+=4){r=p[t.charCodeAt(i)];o=p[t.charCodeAt(i+1)];h=p[t.charCodeAt(i+2)];c=p[t.charCodeAt(i+3)];a[n++]=r<<2|o>>4;a[n++]=(o&15)<<4|h>>2;a[n++]=(h&3)<<6|c&63}return f};const g=typeof ArrayBuffer==="function";const b=(t,s)=>{if(typeof t!=="string"){return{type:"message",data:m(t,s)}}const e=t.charAt(0);if(e==="b"){return{type:"message",data:w(t.substring(1),s)}}const i=o[e];if(!i){return h}return t.length>1?{type:o[e],data:t.substring(1)}:{type:o[e]}};const w=(t,s)=>{if(g){const e=y(t);return m(e,s)}else{return{base64:true,data:t}}};const m=(t,s)=>{switch(s){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};const k=String.fromCharCode(30);const v=(t,s)=>{const e=t.length;const i=new Array(e);let n=0;t.forEach(((t,r)=>{u(t,false,(t=>{i[r]=t;if(++n===e){s(i.join(k))}}))}))};const E=(t,s)=>{const e=t.split(k);const i=[];for(let t=0;t<e.length;t++){const n=b(e[t],s);i.push(n);if(n.type==="error"){break}}return i};const A=4;function O(t){if(t)return x(t)}function x(t){for(var s in O.prototype){t[s]=O.prototype[s]}return t}O.prototype.on=O.prototype.addEventListener=function(t,s){this._callbacks=this._callbacks||{};(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(s);return this};O.prototype.once=function(t,s){function e(){this.off(t,e);s.apply(this,arguments)}e.fn=s;this.on(t,e);return this};O.prototype.off=O.prototype.removeListener=O.prototype.removeAllListeners=O.prototype.removeEventListener=function(t,s){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var e=this._callbacks["$"+t];if(!e)return this;if(1==arguments.length){delete this._callbacks["$"+t];return this}var i;for(var n=0;n<e.length;n++){i=e[n];if(i===s||i.fn===s){e.splice(n,1);break}}if(e.length===0){delete this._callbacks["$"+t]}return this};O.prototype.emit=function(t){this._callbacks=this._callbacks||{};var s=new Array(arguments.length-1),e=this._callbacks["$"+t];for(var i=1;i<arguments.length;i++){s[i-1]=arguments[i]}if(e){e=e.slice(0);for(var i=0,n=e.length;i<n;++i){e[i].apply(this,s)}}return this};O.prototype.emitReserved=O.prototype.emit;O.prototype.listeners=function(t){this._callbacks=this._callbacks||{};return this._callbacks["$"+t]||[]};O.prototype.hasListeners=function(t){return!!this.listeners(t).length};const j=(()=>{if(typeof self!=="undefined"){return self}else if(typeof window!=="undefined"){return window}else{return Function("return this")()}})();function B(t,...s){return s.reduce(((s,e)=>{if(t.hasOwnProperty(e)){s[e]=t[e]}return s}),{})}const C=setTimeout;const N=clearTimeout;function T(t,s){if(s.useNativeTimers){t.setTimeoutFn=C.bind(j);t.clearTimeoutFn=N.bind(j)}else{t.setTimeoutFn=setTimeout.bind(j);t.clearTimeoutFn=clearTimeout.bind(j)}}const _=1.33;function L(t){if(typeof t==="string"){return M(t)}return Math.ceil((t.byteLength||t.size)*_)}function M(t){let s=0,e=0;for(let i=0,n=t.length;i<n;i++){s=t.charCodeAt(i);if(s<128){e+=1}else if(s<2048){e+=2}else if(s<55296||s>=57344){e+=3}else{i++;e+=4}}return e}class P extends Error{constructor(t,s,e){super(t);this.description=s;this.context=e;this.type="TransportError"}}class R extends O{constructor(t){super();this.writable=false;T(this,t);this.opts=t;this.query=t.query;this.readyState="";this.socket=t.socket}onError(t,s,e){super.emitReserved("error",new P(t,s,e));return this}open(){if("closed"===this.readyState||""===this.readyState){this.readyState="opening";this.doOpen()}return this}close(){if("opening"===this.readyState||"open"===this.readyState){this.doClose();this.onClose()}return this}send(t){if("open"===this.readyState){this.write(t)}}onOpen(){this.readyState="open";this.writable=true;super.emitReserved("open")}onData(t){const s=b(t,this.socket.binaryType);this.onPacket(s)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed";super.emitReserved("close",t)}}const U="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),D=64;let I=0,S;function $(t){let s="";do{s=U[t%D]+s;t=Math.floor(t/D)}while(t>0);return s}function F(){const t=$(+new Date);if(t!==S)return I=0,S=t;return t+"."+$(I++)}function q(t){let s="";for(let e in t){if(t.hasOwnProperty(e)){if(s.length)s+="&";s+=encodeURIComponent(e)+"="+encodeURIComponent(t[e])}}return s}function H(t){let s={};let e=t.split("&");for(let t=0,i=e.length;t<i;t++){let i=e[t].split("=");s[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return s}let X=false;try{X=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){}const z=X;function V(t){const s=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!s||z)){return new XMLHttpRequest}}catch(t){}if(!s){try{return new(j[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}function J(){}const K=function(){const t=new V({xdomain:false});return null!=t.responseType}();class W extends R{constructor(t){super(t);this.polling=false;if(typeof location!=="undefined"){const s="https:"===location.protocol;let e=location.port;if(!e){e=s?"443":"80"}this.xd=typeof location!=="undefined"&&t.hostname!==location.hostname||e!==t.port;this.xs=t.secure!==s}const s=t&&t.forceBase64;this.supportsBinary=K&&!s}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const s=()=>{this.readyState="paused";t()};if(this.polling||!this.writable){let t=0;if(this.polling){t++;this.once("pollComplete",(function(){--t||s()}))}if(!this.writable){t++;this.once("drain",(function(){--t||s()}))}}else{s()}}poll(){this.polling=true;this.doPoll();this.emitReserved("poll")}onData(t){const s=t=>{if("opening"===this.readyState&&t.type==="open"){this.onOpen()}if("close"===t.type){this.onClose({description:"transport closed by the server"});return false}this.onPacket(t)};E(t,this.socket.binaryType).forEach(s);if("closed"!==this.readyState){this.polling=false;this.emitReserved("pollComplete");if("open"===this.readyState){this.poll()}}}doClose(){const t=()=>{this.write([{type:"close"}])};if("open"===this.readyState){t()}else{this.once("open",t)}}write(t){this.writable=false;v(t,(t=>{this.doWrite(t,(()=>{this.writable=true;this.emitReserved("drain")}))}))}uri(){let t=this.query||{};const s=this.opts.secure?"https":"http";let e="";if(false!==this.opts.timestampRequests){t[this.opts.timestampParam]=F()}if(!this.supportsBinary&&!t.sid){t.b64=1}if(this.opts.port&&("https"===s&&Number(this.opts.port)!==443||"http"===s&&Number(this.opts.port)!==80)){e=":"+this.opts.port}const i=q(t);const n=this.opts.hostname.indexOf(":")!==-1;return s+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+e+this.opts.path+(i.length?"?"+i:"")}request(t={}){Object.assign(t,{xd:this.xd,xs:this.xs},this.opts);return new Y(this.uri(),t)}doWrite(t,s){const e=this.request({method:"POST",data:t});e.on("success",s);e.on("error",((t,s)=>{this.onError("xhr post error",t,s)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this));t.on("error",((t,s)=>{this.onError("xhr poll error",t,s)}));this.pollXhr=t}}class Y extends O{constructor(t,s){super();T(this,s);this.opts=s;this.method=s.method||"GET";this.uri=t;this.async=false!==s.async;this.data=undefined!==s.data?s.data:null;this.create()}create(){const t=B(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;t.xscheme=!!this.opts.xs;const s=this.xhr=new V(t);try{s.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(true);for(let t in this.opts.extraHeaders){if(this.opts.extraHeaders.hasOwnProperty(t)){s.setRequestHeader(t,this.opts.extraHeaders[t])}}}}catch(t){}if("POST"===this.method){try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}}try{s.setRequestHeader("Accept","*/*")}catch(t){}if("withCredentials"in s){s.withCredentials=this.opts.withCredentials}if(this.opts.requestTimeout){s.timeout=this.opts.requestTimeout}s.onreadystatechange=()=>{if(4!==s.readyState)return;if(200===s.status||1223===s.status){this.onLoad()}else{this.setTimeoutFn((()=>{this.onError(typeof s.status==="number"?s.status:0)}),0)}};s.send(this.data)}catch(t){this.setTimeoutFn((()=>{this.onError(t)}),0);return}if(typeof document!=="undefined"){this.index=Y.requestsCount++;Y.requests[this.index]=this}}onError(t){this.emitReserved("error",t,this.xhr);this.cleanup(true)}cleanup(t){if("undefined"===typeof this.xhr||null===this.xhr){return}this.xhr.onreadystatechange=J;if(t){try{this.xhr.abort()}catch(t){}}if(typeof document!=="undefined"){delete Y.requests[this.index]}this.xhr=null}onLoad(){const t=this.xhr.responseText;if(t!==null){this.emitReserved("data",t);this.emitReserved("success");this.cleanup()}}abort(){this.cleanup()}}Y.requestsCount=0;Y.requests={};if(typeof document!=="undefined"){if(typeof attachEvent==="function"){attachEvent("onunload",G)}else if(typeof addEventListener==="function"){const t="onpagehide"in j?"pagehide":"unload";addEventListener(t,G,false)}}function G(){for(let t in Y.requests){if(Y.requests.hasOwnProperty(t)){Y.requests[t].abort()}}}const Q=(()=>{const t=typeof Promise==="function"&&typeof Promise.resolve==="function";if(t){return t=>Promise.resolve().then(t)}else{return(t,s)=>s(t,0)}})();const Z=j.WebSocket||j.MozWebSocket;const tt="arraybuffer";const st=typeof navigator!=="undefined"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";class et extends R{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check()){return}const t=this.uri();const s=this.opts.protocols;const e=st?{}:B(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");if(this.opts.extraHeaders){e.headers=this.opts.extraHeaders}try{this.ws=!st?s?new Z(t,s):new Z(t):new Z(t,s,e)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||tt;this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{if(this.opts.autoUnref){this.ws._socket.unref()}this.onOpen()};this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t});this.ws.onmessage=t=>this.onData(t.data);this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=false;for(let s=0;s<t.length;s++){const e=t[s];const i=s===t.length-1;u(e,this.supportsBinary,(t=>{try{{this.ws.send(t)}}catch(t){}if(i){Q((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){if(typeof this.ws!=="undefined"){this.ws.close();this.ws=null}}uri(){let t=this.query||{};const s=this.opts.secure?"wss":"ws";let e="";if(this.opts.port&&("wss"===s&&Number(this.opts.port)!==443||"ws"===s&&Number(this.opts.port)!==80)){e=":"+this.opts.port}if(this.opts.timestampRequests){t[this.opts.timestampParam]=F()}if(!this.supportsBinary){t.b64=1}const i=q(t);const n=this.opts.hostname.indexOf(":")!==-1;return s+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+e+this.opts.path+(i.length?"?"+i:"")}check(){return!!Z}}const it={websocket:et,polling:W};const nt=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;const rt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ot(t){const s=t,e=t.indexOf("["),i=t.indexOf("]");if(e!=-1&&i!=-1){t=t.substring(0,e)+t.substring(e,i).replace(/:/g,";")+t.substring(i,t.length)}let n=nt.exec(t||""),r={},o=14;while(o--){r[rt[o]]=n[o]||""}if(e!=-1&&i!=-1){r.source=s;r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":");r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":");r.ipv6uri=true}r.pathNames=ht(r,r["path"]);r.queryKey=ct(r,r["query"]);return r}function ht(t,s){const e=/\/{2,9}/g,i=s.replace(e,"/").split("/");if(s.substr(0,1)=="/"||s.length===0){i.splice(0,1)}if(s.substr(s.length-1,1)=="/"){i.splice(i.length-1,1)}return i}function ct(t,s){const e={};s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,s,i){if(s){e[s]=i}}));return e}class ft extends O{constructor(t,s={}){super();if(t&&"object"===typeof t){s=t;t=null}if(t){t=ot(t);s.hostname=t.host;s.secure=t.protocol==="https"||t.protocol==="wss";s.port=t.port;if(t.query)s.query=t.query}else if(s.host){s.hostname=ot(s.host).host}T(this,s);this.secure=null!=s.secure?s.secure:typeof location!=="undefined"&&"https:"===location.protocol;if(s.hostname&&!s.port){s.port=this.secure?"443":"80"}this.hostname=s.hostname||(typeof location!=="undefined"?location.hostname:"localhost");this.port=s.port||(typeof location!=="undefined"&&location.port?location.port:this.secure?"443":"80");this.transports=s.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.opts=Object.assign({path:"/engine.io",agent:false,withCredentials:false,upgrade:true,timestampParam:"t",rememberUpgrade:false,rejectUnauthorized:true,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:true},s);this.opts.path=this.opts.path.replace(/\/$/,"")+"/";if(typeof this.opts.query==="string"){this.opts.query=H(this.opts.query)}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingTimeoutTimer=null;if(typeof addEventListener==="function"){if(this.opts.closeOnBeforeunload){addEventListener("beforeunload",(()=>{if(this.transport){this.transport.removeAllListeners();this.transport.close()}}),false)}if(this.hostname!=="localhost"){this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})};addEventListener("offline",this.offlineEventListener,false)}}this.open()}createTransport(t){const s=Object.assign({},this.opts.query);s.EIO=A;s.transport=t;if(this.id)s.sid=this.id;const e=Object.assign({},this.opts.transportOptions[t],this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new it[t](e)}open(){let t;if(this.opts.rememberUpgrade&&ft.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){t="websocket"}else if(0===this.transports.length){this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);return}else{t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){this.transports.shift();this.open();return}t.open();this.setTransport(t)}setTransport(t){if(this.transport){this.transport.removeAllListeners()}this.transport=t;t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let s=this.createTransport(t);let e=false;ft.priorWebsocketSuccess=false;const i=()=>{if(e)return;s.send([{type:"ping",data:"probe"}]);s.once("packet",(t=>{if(e)return;if("pong"===t.type&&"probe"===t.data){this.upgrading=true;this.emitReserved("upgrading",s);if(!s)return;ft.priorWebsocketSuccess="websocket"===s.name;this.transport.pause((()=>{if(e)return;if("closed"===this.readyState)return;f();this.setTransport(s);s.send([{type:"upgrade"}]);this.emitReserved("upgrade",s);s=null;this.upgrading=false;this.flush()}))}else{const t=new Error("probe error");t.transport=s.name;this.emitReserved("upgradeError",t)}}))};function n(){if(e)return;e=true;f();s.close();s=null}const r=t=>{const e=new Error("probe error: "+t);e.transport=s.name;n();this.emitReserved("upgradeError",e)};function o(){r("transport closed")}function h(){r("socket closed")}function c(t){if(s&&t.name!==s.name){n()}}const f=()=>{s.removeListener("open",i);s.removeListener("error",r);s.removeListener("close",o);this.off("close",h);this.off("upgrading",c)};s.once("open",i);s.once("error",r);s.once("close",o);this.once("close",h);this.once("upgrading",c);s.open()}onOpen(){this.readyState="open";ft.priorWebsocketSuccess="websocket"===this.transport.name;this.emitReserved("open");this.flush();if("open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const s=this.upgrades.length;for(;t<s;t++){this.probe(this.upgrades[t])}}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.emitReserved("packet",t);this.emitReserved("heartbeat");switch(t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout();this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case"error":const s=new Error("server error");s.code=t.data;this.onError(s);break;case"message":this.emitReserved("data",t.data);this.emitReserved("message",t.data);break}}}onHandshake(t){this.emitReserved("handshake",t);this.id=t.sid;this.transport.query.sid=t.sid;this.upgrades=this.filterUpgrades(t.upgrades);this.pingInterval=t.pingInterval;this.pingTimeout=t.pingTimeout;this.maxPayload=t.maxPayload;this.onOpen();if("closed"===this.readyState)return;this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout);if(this.opts.autoUnref){this.pingTimeoutTimer.unref()}}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emitReserved("drain")}else{this.flush()}}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t);this.prevBufferLen=t.length;this.emitReserved("flush")}}getWritablePackets(){const t=this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1;if(!t){return this.writeBuffer}let s=1;for(let t=0;t<this.writeBuffer.length;t++){const e=this.writeBuffer[t].data;if(e){s+=L(e)}if(t>0&&s>this.maxPayload){return this.writeBuffer.slice(0,t)}s+=2}return this.writeBuffer}write(t,s,e){this.sendPacket("message",t,s,e);return this}send(t,s,e){this.sendPacket("message",t,s,e);return this}sendPacket(t,s,e,i){if("function"===typeof s){i=s;s=undefined}if("function"===typeof e){i=e;e=null}if("closing"===this.readyState||"closed"===this.readyState){return}e=e||{};e.compress=false!==e.compress;const n={type:t,data:s,options:e};this.emitReserved("packetCreate",n);this.writeBuffer.push(n);if(i)this.once("flush",i);this.flush()}close(){const t=()=>{this.onClose("forced close");this.transport.close()};const s=()=>{this.off("upgrade",s);this.off("upgradeError",s);t()};const e=()=>{this.once("upgrade",s);this.once("upgradeError",s)};if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";if(this.writeBuffer.length){this.once("drain",(()=>{if(this.upgrading){e()}else{t()}}))}else if(this.upgrading){e()}else{t()}}return this}onError(t){ft.priorWebsocketSuccess=false;this.emitReserved("error",t);this.onClose("transport error",t)}onClose(t,s){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.clearTimeoutFn(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();if(typeof removeEventListener==="function"){removeEventListener("offline",this.offlineEventListener,false)}this.readyState="closed";this.id=null;this.emitReserved("close",t,s);this.writeBuffer=[];this.prevBufferLen=0}}filterUpgrades(t){const s=[];let e=0;const i=t.length;for(;e<i;e++){if(~this.transports.indexOf(t[e]))s.push(t[e])}return s}}ft.protocol=A;function at(t,s="",e){let i=t;e=e||typeof location!=="undefined"&&location;if(null==t)t=e.protocol+"//"+e.host;if(typeof t==="string"){if("/"===t.charAt(0)){if("/"===t.charAt(1)){t=e.protocol+t}else{t=e.host+t}}if(!/^(https?|wss?):\/\//.test(t)){if("undefined"!==typeof e){t=e.protocol+"//"+t}else{t="https://"+t}}i=ot(t)}if(!i.port){if(/^(http|ws)$/.test(i.protocol)){i.port="80"}else if(/^(http|ws)s$/.test(i.protocol)){i.port="443"}}i.path=i.path||"/";const n=i.host.indexOf(":")!==-1;const r=n?"["+i.host+"]":i.host;i.id=i.protocol+"://"+r+":"+i.port+s;i.href=i.protocol+"://"+r+(e&&e.port===i.port?"":":"+i.port);return i}const ut=typeof ArrayBuffer==="function";const lt=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer;const dt=Object.prototype.toString;const pt=typeof Blob==="function"||typeof Blob!=="undefined"&&dt.call(Blob)==="[object BlobConstructor]";const yt=typeof File==="function"||typeof File!=="undefined"&&dt.call(File)==="[object FileConstructor]";function gt(t){return ut&&(t instanceof ArrayBuffer||lt(t))||pt&&t instanceof Blob||yt&&t instanceof File}function bt(t,s){if(!t||typeof t!=="object"){return false}if(Array.isArray(t)){for(let s=0,e=t.length;s<e;s++){if(bt(t[s])){return true}}return false}if(gt(t)){return true}if(t.toJSON&&typeof t.toJSON==="function"&&arguments.length===1){return bt(t.toJSON(),true)}for(const s in t){if(Object.prototype.hasOwnProperty.call(t,s)&&bt(t[s])){return true}}return false}function wt(t){const s=[];const e=t.data;const i=t;i.data=mt(e,s);i.attachments=s.length;return{packet:i,buffers:s}}function mt(t,s){if(!t)return t;if(gt(t)){const e={_placeholder:true,num:s.length};s.push(t);return e}else if(Array.isArray(t)){const e=new Array(t.length);for(let i=0;i<t.length;i++){e[i]=mt(t[i],s)}return e}else if(typeof t==="object"&&!(t instanceof Date)){const e={};for(const i in t){if(Object.prototype.hasOwnProperty.call(t,i)){e[i]=mt(t[i],s)}}return e}return t}function kt(t,s){t.data=vt(t.data,s);t.attachments=undefined;return t}function vt(t,s){if(!t)return t;if(t&&t._placeholder===true){const e=typeof t.num==="number"&&t.num>=0&&t.num<s.length;if(e){return s[t.num]}else{throw new Error("illegal attachments")}}else if(Array.isArray(t)){for(let e=0;e<t.length;e++){t[e]=vt(t[e],s)}}else if(typeof t==="object"){for(const e in t){if(Object.prototype.hasOwnProperty.call(t,e)){t[e]=vt(t[e],s)}}}return t}const Et=5;var At;(function(t){t[t["CONNECT"]=0]="CONNECT";t[t["DISCONNECT"]=1]="DISCONNECT";t[t["EVENT"]=2]="EVENT";t[t["ACK"]=3]="ACK";t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR";t[t["BINARY_EVENT"]=5]="BINARY_EVENT";t[t["BINARY_ACK"]=6]="BINARY_ACK"})(At||(At={}));class Ot{constructor(t){this.replacer=t}encode(t){if(t.type===At.EVENT||t.type===At.ACK){if(bt(t)){t.type=t.type===At.EVENT?At.BINARY_EVENT:At.BINARY_ACK;return this.encodeAsBinary(t)}}return[this.encodeAsString(t)]}encodeAsString(t){let s=""+t.type;if(t.type===At.BINARY_EVENT||t.type===At.BINARY_ACK){s+=t.attachments+"-"}if(t.nsp&&"/"!==t.nsp){s+=t.nsp+","}if(null!=t.id){s+=t.id}if(null!=t.data){s+=JSON.stringify(t.data,this.replacer)}return s}encodeAsBinary(t){const s=wt(t);const e=this.encodeAsString(s.packet);const i=s.buffers;i.unshift(e);return i}}class xt extends O{constructor(t){super();this.reviver=t}add(t){let s;if(typeof t==="string"){if(this.reconstructor){throw new Error("got plaintext data when reconstructing a packet")}s=this.decodeString(t);if(s.type===At.BINARY_EVENT||s.type===At.BINARY_ACK){this.reconstructor=new jt(s);if(s.attachments===0){super.emitReserved("decoded",s)}}else{super.emitReserved("decoded",s)}}else if(gt(t)||t.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{s=this.reconstructor.takeBinaryData(t);if(s){this.reconstructor=null;super.emitReserved("decoded",s)}}}else{throw new Error("Unknown type: "+t)}}decodeString(t){let s=0;const e={type:Number(t.charAt(0))};if(At[e.type]===undefined){throw new Error("unknown packet type "+e.type)}if(e.type===At.BINARY_EVENT||e.type===At.BINARY_ACK){const i=s+1;while(t.charAt(++s)!=="-"&&s!=t.length){}const n=t.substring(i,s);if(n!=Number(n)||t.charAt(s)!=="-"){throw new Error("Illegal attachments")}e.attachments=Number(n)}if("/"===t.charAt(s+1)){const i=s+1;while(++s){const e=t.charAt(s);if(","===e)break;if(s===t.length)break}e.nsp=t.substring(i,s)}else{e.nsp="/"}const i=t.charAt(s+1);if(""!==i&&Number(i)==i){const i=s+1;while(++s){const e=t.charAt(s);if(null==e||Number(e)!=e){--s;break}if(s===t.length)break}e.id=Number(t.substring(i,s+1))}if(t.charAt(++s)){const i=this.tryParse(t.substr(s));if(xt.isPayloadValid(e.type,i)){e.data=i}else{throw new Error("invalid payload")}}return e}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return false}}static isPayloadValid(t,s){switch(t){case At.CONNECT:return typeof s==="object";case At.DISCONNECT:return s===undefined;case At.CONNECT_ERROR:return typeof s==="string"||typeof s==="object";case At.EVENT:case At.BINARY_EVENT:return Array.isArray(s)&&s.length>0;case At.ACK:case At.BINARY_ACK:return Array.isArray(s)}}destroy(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}}}class jt{constructor(t){this.packet=t;this.buffers=[];this.reconPack=t}takeBinaryData(t){this.buffers.push(t);if(this.buffers.length===this.reconPack.attachments){const t=kt(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null}finishedReconstruction(){this.reconPack=null;this.buffers=[]}}const Bt=Object.freeze({__proto__:null,protocol:Et,get PacketType(){return At},Encoder:Ot,Decoder:xt});function Ct(t,s,e){t.on(s,e);return function i(){t.off(s,e)}}const Nt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Tt extends O{constructor(t,s,e){super();this.connected=false;this.receiveBuffer=[];this.sendBuffer=[];this.ids=0;this.acks={};this.flags={};this.io=t;this.nsp=s;if(e&&e.auth){this.auth=e.auth}if(this.io._autoConnect)this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ct(t,"open",this.onopen.bind(this)),Ct(t,"packet",this.onpacket.bind(this)),Ct(t,"error",this.onerror.bind(this)),Ct(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){if(this.connected)return this;this.subEvents();if(!this.io["_reconnecting"])this.io.open();if("open"===this.io._readyState)this.onopen();return this}open(){return this.connect()}send(...t){t.unshift("message");this.emit.apply(this,t);return this}emit(t,...s){if(Nt.hasOwnProperty(t)){throw new Error('"'+t+'" is a reserved event name')}s.unshift(t);const e={type:At.EVENT,data:s};e.options={};e.options.compress=this.flags.compress!==false;if("function"===typeof s[s.length-1]){const t=this.ids++;const i=s.pop();this._registerAckCallback(t,i);e.id=t}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;const n=this.flags.volatile&&(!i||!this.connected);if(n);else if(this.connected){this.notifyOutgoingListeners(e);this.packet(e)}else{this.sendBuffer.push(e)}this.flags={};return this}_registerAckCallback(t,s){const e=this.flags.timeout;if(e===undefined){this.acks[t]=s;return}const i=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let s=0;s<this.sendBuffer.length;s++){if(this.sendBuffer[s].id===t){this.sendBuffer.splice(s,1)}}s.call(this,new Error("operation has timed out"))}),e);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(i);s.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp;this.io._packet(t)}onopen(){if(typeof this.auth=="function"){this.auth((t=>{this.packet({type:At.CONNECT,data:t})}))}else{this.packet({type:At.CONNECT,data:this.auth})}}onerror(t){if(!this.connected){this.emitReserved("connect_error",t)}}onclose(t,s){this.connected=false;delete this.id;this.emitReserved("disconnect",t,s)}onpacket(t){const s=t.nsp===this.nsp;if(!s)return;switch(t.type){case At.CONNECT:if(t.data&&t.data.sid){const s=t.data.sid;this.onconnect(s)}else{this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"))}break;case At.EVENT:case At.BINARY_EVENT:this.onevent(t);break;case At.ACK:case At.BINARY_ACK:this.onack(t);break;case At.DISCONNECT:this.ondisconnect();break;case At.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data;this.emitReserved("connect_error",s);break}}onevent(t){const s=t.data||[];if(null!=t.id){s.push(this.ack(t.id))}if(this.connected){this.emitEvent(s)}else{this.receiveBuffer.push(Object.freeze(s))}}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const e of s){e.apply(this,t)}}super.emit.apply(this,t)}ack(t){const s=this;let e=false;return function(...i){if(e)return;e=true;s.packet({type:At.ACK,id:t,data:i})}}onack(t){const s=this.acks[t.id];if("function"===typeof s){s.apply(this,t.data);delete this.acks[t.id]}}onconnect(t){this.id=t;this.connected=true;this.emitBuffered();this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t)));this.receiveBuffer=[];this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t);this.packet(t)}));this.sendBuffer=[]}ondisconnect(){this.destroy();this.onclose("io server disconnect")}destroy(){if(this.subs){this.subs.forEach((t=>t()));this.subs=undefined}this.io["_destroy"](this)}disconnect(){if(this.connected){this.packet({type:At.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this}close(){return this.disconnect()}compress(t){this.flags.compress=t;return this}get volatile(){this.flags.volatile=true;return this}timeout(t){this.flags.timeout=t;return this}onAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.push(t);return this}prependAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.unshift(t);return this}offAny(t){if(!this._anyListeners){return this}if(t){const s=this._anyListeners;for(let e=0;e<s.length;e++){if(t===s[e]){s.splice(e,1);return this}}}else{this._anyListeners=[]}return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.push(t);return this}prependAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.unshift(t);return this}offAnyOutgoing(t){if(!this._anyOutgoingListeners){return this}if(t){const s=this._anyOutgoingListeners;for(let e=0;e<s.length;e++){if(t===s[e]){s.splice(e,1);return this}}}else{this._anyOutgoingListeners=[]}return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const e of s){e.apply(this,t.data)}}}}function _t(t){t=t||{};this.ms=t.min||100;this.max=t.max||1e4;this.factor=t.factor||2;this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0;this.attempts=0}_t.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random();var e=Math.floor(s*this.jitter*t);t=(Math.floor(s*10)&1)==0?t-e:t+e}return Math.min(t,this.max)|0};_t.prototype.reset=function(){this.attempts=0};_t.prototype.setMin=function(t){this.ms=t};_t.prototype.setMax=function(t){this.max=t};_t.prototype.setJitter=function(t){this.jitter=t};class Lt extends O{constructor(t,s){var e;super();this.nsps={};this.subs=[];if(t&&"object"===typeof t){s=t;t=undefined}s=s||{};s.path=s.path||"/socket.io";this.opts=s;T(this,s);this.reconnection(s.reconnection!==false);this.reconnectionAttempts(s.reconnectionAttempts||Infinity);this.reconnectionDelay(s.reconnectionDelay||1e3);this.reconnectionDelayMax(s.reconnectionDelayMax||5e3);this.randomizationFactor((e=s.randomizationFactor)!==null&&e!==void 0?e:.5);this.backoff=new _t({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==s.timeout?2e4:s.timeout);this._readyState="closed";this.uri=t;const i=s.parser||Bt;this.encoder=new i.Encoder;this.decoder=new i.Decoder;this._autoConnect=s.autoConnect!==false;if(this._autoConnect)this.open()}reconnection(t){if(!arguments.length)return this._reconnection;this._reconnection=!!t;return this}reconnectionAttempts(t){if(t===undefined)return this._reconnectionAttempts;this._reconnectionAttempts=t;return this}reconnectionDelay(t){var s;if(t===undefined)return this._reconnectionDelay;this._reconnectionDelay=t;(s=this.backoff)===null||s===void 0?void 0:s.setMin(t);return this}randomizationFactor(t){var s;if(t===undefined)return this._randomizationFactor;this._randomizationFactor=t;(s=this.backoff)===null||s===void 0?void 0:s.setJitter(t);return this}reconnectionDelayMax(t){var s;if(t===undefined)return this._reconnectionDelayMax;this._reconnectionDelayMax=t;(s=this.backoff)===null||s===void 0?void 0:s.setMax(t);return this}timeout(t){if(!arguments.length)return this._timeout;this._timeout=t;return this}maybeReconnectOnOpen(){if(!this._reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new ft(this.uri,this.opts);const s=this.engine;const e=this;this._readyState="opening";this.skipReconnect=false;const i=Ct(s,"open",(function(){e.onopen();t&&t()}));const n=Ct(s,"error",(s=>{e.cleanup();e._readyState="closed";this.emitReserved("error",s);if(t){t(s)}else{e.maybeReconnectOnOpen()}}));if(false!==this._timeout){const t=this._timeout;if(t===0){i()}const e=this.setTimeoutFn((()=>{i();s.close();s.emit("error",new Error("timeout"))}),t);if(this.opts.autoUnref){e.unref()}this.subs.push((function t(){clearTimeout(e)}))}this.subs.push(i);this.subs.push(n);return this}connect(t){return this.open(t)}onopen(){this.cleanup();this._readyState="open";this.emitReserved("open");const t=this.engine;this.subs.push(Ct(t,"ping",this.onping.bind(this)),Ct(t,"data",this.ondata.bind(this)),Ct(t,"error",this.onerror.bind(this)),Ct(t,"close",this.onclose.bind(this)),Ct(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,s){let e=this.nsps[t];if(!e){e=new Tt(this,t,s);this.nsps[t]=e}return e}_destroy(t){const s=Object.keys(this.nsps);for(const t of s){const s=this.nsps[t];if(s.active){return}}this._close()}_packet(t){const s=this.encoder.encode(t);for(let e=0;e<s.length;e++){this.engine.write(s[e],t.options)}}cleanup(){this.subs.forEach((t=>t()));this.subs.length=0;this.decoder.destroy()}_close(){this.skipReconnect=true;this._reconnecting=false;this.onclose("forced close");if(this.engine)this.engine.close()}disconnect(){return this._close()}onclose(t,s){this.cleanup();this.backoff.reset();this._readyState="closed";this.emitReserved("close",t,s);if(this._reconnection&&!this.skipReconnect){this.reconnect()}}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts){this.backoff.reset();this.emitReserved("reconnect_failed");this._reconnecting=false}else{const s=this.backoff.duration();this._reconnecting=true;const e=this.setTimeoutFn((()=>{if(t.skipReconnect)return;this.emitReserved("reconnect_attempt",t.backoff.attempts);if(t.skipReconnect)return;t.open((s=>{if(s){t._reconnecting=false;t.reconnect();this.emitReserved("reconnect_error",s)}else{t.onreconnect()}}))}),s);if(this.opts.autoUnref){e.unref()}this.subs.push((function t(){clearTimeout(e)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=false;this.backoff.reset();this.emitReserved("reconnect",t)}}const Mt={};function Pt(t,s){if(typeof t==="object"){s=t;t=undefined}s=s||{};const e=at(t,s.path||"/socket.io");const i=e.source;const n=e.id;const r=e.path;const o=Mt[n]&&r in Mt[n]["nsps"];const h=s.forceNew||s["force new connection"]||false===s.multiplex||o;let c;if(h){c=new Lt(i,s)}else{if(!Mt[n]){Mt[n]=new Lt(i,s)}c=Mt[n]}if(e.query&&!s.query){s.query=e.queryKey}return c.socket(e.path,s)}Object.assign(Pt,{Manager:Lt,Socket:Tt,io:Pt,connect:Pt});const Rt=":host{display:block}codenames-board{width:800px}";const Ut=class{constructor(s){t(this,s)}async connectedCallback(){const t=Pt("http://localhost:8000");t.on("updateBoard",(t=>{this.boardData=t}))}render(){return s(e,null,s("codenames-board",{boardData:this.boardData}))}};Ut.style=Rt;const Dt=":host{display:flex;margin:50px;flex-wrap:wrap;justify-content:space-between;height:600px}";const It=class{constructor(s){t(this,s)}render(){var t,i;return s(e,null,(i=(t=this.boardData)===null||t===void 0?void 0:t.map((t=>s("codenames-cell",{word:t.word,color:t.color,mode:t.mode,revealed:t.revealed}))))!==null&&i!==void 0?i:null)}};It.style=Dt;const St=":host{width:18%;height:17%}div{display:flex;justify-content:center;align-items:center;text-align:center;width:100%;height:100%;font-family:Roboto, verdana, sans-serif;font-size:15pt;background:#e8e8e8;cursor:pointer}div.revealed,div.spymaster,div.endgame{cursor:default}.blue.spymaster{color:#4183cc;font-weight:bold}.blue.revealed{background:#4183cc;color:#ffffff}.blue.endgame{background:#a6c7ee}.red.spymaster{color:#d13030;font-weight:bold}.red.revealed{background:#d13030;color:#ffffff}.red.endgame{background:#ecabab}.gray.spymaster{color:#000000;font-weight:bold}.gray.revealed{background:#8e8e8e;color:#ffffff}.black.spymaster{background:#999999;outline:5px solid #000000;font-weight:bold}.black.revealed,.black.endgame{background:#000000;color:#ffffff;outline:0}";const $t=class{constructor(s){t(this,s);this.word="";this.color=i.Gray;this.mode=n.Normal;this.revealed=false;this.showSpinner=false;this.revealCell=async()=>{if(this.mode===n.Normal&&this.revealed===false){this.showSpinner=true;setTimeout((()=>{this.showSpinner=false;this.revealed=true}),500)}}}render(){return s("div",{class:`${this.color} ${this.mode} ${this.revealed?"revealed":""}`,onClick:this.revealCell},this.showSpinner?s("codenames-spinner",null):s("span",null,this.word.toUpperCase()))}};$t.style=St;const Ft=':host{display:block}.lds-dual-ring:after{content:" ";display:block;width:32px;height:32px;margin:4px;border-radius:50%;border:4px solid #000;border-color:#000 transparent #000 transparent;animation:lds-dual-ring 1.2s linear infinite}@keyframes lds-dual-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}';const qt=class{constructor(s){t(this,s)}render(){return s(e,null,s("div",{class:"lds-dual-ring"}))}};qt.style=Ft;export{Ut as codenames_app,It as codenames_board,$t as codenames_cell,qt as codenames_spinner};
//# sourceMappingURL=p-c3215bb5.entry.js.map
import{r as t,h as s,H as e,c as i}from"./p-e8605e2f.js";import{C as n,a as r}from"./p-9f42e523.js";const o=Object.create(null);o["open"]="0";o["close"]="1";o["ping"]="2";o["pong"]="3";o["message"]="4";o["upgrade"]="5";o["noop"]="6";const h=Object.create(null);Object.keys(o).forEach((t=>{h[o[t]]=t}));const c={type:"error",data:"parser error"};const f=typeof Blob==="function"||typeof Blob!=="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]";const a=typeof ArrayBuffer==="function";const u=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer;const l=({type:t,data:s},e,i)=>{if(f&&s instanceof Blob){if(e){return i(s)}else{return d(s,i)}}else if(a&&(s instanceof ArrayBuffer||u(s))){if(e){return i(s)}else{return d(new Blob([s]),i)}}return i(o[t]+(s||""))};const d=(t,s)=>{const e=new FileReader;e.onload=function(){const t=e.result.split(",")[1];s("b"+t)};return e.readAsDataURL(t)};const p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const y=typeof Uint8Array==="undefined"?[]:new Uint8Array(256);for(let t=0;t<p.length;t++){y[p.charCodeAt(t)]=t}const g=t=>{let s=t.length*.75,e=t.length,i,n=0,r,o,h,c;if(t[t.length-1]==="="){s--;if(t[t.length-2]==="="){s--}}const f=new ArrayBuffer(s),a=new Uint8Array(f);for(i=0;i<e;i+=4){r=y[t.charCodeAt(i)];o=y[t.charCodeAt(i+1)];h=y[t.charCodeAt(i+2)];c=y[t.charCodeAt(i+3)];a[n++]=r<<2|o>>4;a[n++]=(o&15)<<4|h>>2;a[n++]=(h&3)<<6|c&63}return f};const b=typeof ArrayBuffer==="function";const w=(t,s)=>{if(typeof t!=="string"){return{type:"message",data:k(t,s)}}const e=t.charAt(0);if(e==="b"){return{type:"message",data:m(t.substring(1),s)}}const i=h[e];if(!i){return c}return t.length>1?{type:h[e],data:t.substring(1)}:{type:h[e]}};const m=(t,s)=>{if(b){const e=g(t);return k(e,s)}else{return{base64:true,data:t}}};const k=(t,s)=>{switch(s){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};const v=String.fromCharCode(30);const E=(t,s)=>{const e=t.length;const i=new Array(e);let n=0;t.forEach(((t,r)=>{l(t,false,(t=>{i[r]=t;if(++n===e){s(i.join(v))}}))}))};const A=(t,s)=>{const e=t.split(v);const i=[];for(let t=0;t<e.length;t++){const n=w(e[t],s);i.push(n);if(n.type==="error"){break}}return i};const O=4;function x(t){if(t)return j(t)}function j(t){for(var s in x.prototype){t[s]=x.prototype[s]}return t}x.prototype.on=x.prototype.addEventListener=function(t,s){this._callbacks=this._callbacks||{};(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(s);return this};x.prototype.once=function(t,s){function e(){this.off(t,e);s.apply(this,arguments)}e.fn=s;this.on(t,e);return this};x.prototype.off=x.prototype.removeListener=x.prototype.removeAllListeners=x.prototype.removeEventListener=function(t,s){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var e=this._callbacks["$"+t];if(!e)return this;if(1==arguments.length){delete this._callbacks["$"+t];return this}var i;for(var n=0;n<e.length;n++){i=e[n];if(i===s||i.fn===s){e.splice(n,1);break}}if(e.length===0){delete this._callbacks["$"+t]}return this};x.prototype.emit=function(t){this._callbacks=this._callbacks||{};var s=new Array(arguments.length-1),e=this._callbacks["$"+t];for(var i=1;i<arguments.length;i++){s[i-1]=arguments[i]}if(e){e=e.slice(0);for(var i=0,n=e.length;i<n;++i){e[i].apply(this,s)}}return this};x.prototype.emitReserved=x.prototype.emit;x.prototype.listeners=function(t){this._callbacks=this._callbacks||{};return this._callbacks["$"+t]||[]};x.prototype.hasListeners=function(t){return!!this.listeners(t).length};const B=(()=>{if(typeof self!=="undefined"){return self}else if(typeof window!=="undefined"){return window}else{return Function("return this")()}})();function C(t,...s){return s.reduce(((s,e)=>{if(t.hasOwnProperty(e)){s[e]=t[e]}return s}),{})}const N=setTimeout;const T=clearTimeout;function _(t,s){if(s.useNativeTimers){t.setTimeoutFn=N.bind(B);t.clearTimeoutFn=T.bind(B)}else{t.setTimeoutFn=setTimeout.bind(B);t.clearTimeoutFn=clearTimeout.bind(B)}}const L=1.33;function M(t){if(typeof t==="string"){return P(t)}return Math.ceil((t.byteLength||t.size)*L)}function P(t){let s=0,e=0;for(let i=0,n=t.length;i<n;i++){s=t.charCodeAt(i);if(s<128){e+=1}else if(s<2048){e+=2}else if(s<55296||s>=57344){e+=3}else{i++;e+=4}}return e}class R extends Error{constructor(t,s,e){super(t);this.description=s;this.context=e;this.type="TransportError"}}class U extends x{constructor(t){super();this.writable=false;_(this,t);this.opts=t;this.query=t.query;this.readyState="";this.socket=t.socket}onError(t,s,e){super.emitReserved("error",new R(t,s,e));return this}open(){if("closed"===this.readyState||""===this.readyState){this.readyState="opening";this.doOpen()}return this}close(){if("opening"===this.readyState||"open"===this.readyState){this.doClose();this.onClose()}return this}send(t){if("open"===this.readyState){this.write(t)}}onOpen(){this.readyState="open";this.writable=true;super.emitReserved("open")}onData(t){const s=w(t,this.socket.binaryType);this.onPacket(s)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed";super.emitReserved("close",t)}}const D="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),I=64;let S=0,$;function F(t){let s="";do{s=D[t%I]+s;t=Math.floor(t/I)}while(t>0);return s}function q(){const t=F(+new Date);if(t!==$)return S=0,$=t;return t+"."+F(S++)}function H(t){let s="";for(let e in t){if(t.hasOwnProperty(e)){if(s.length)s+="&";s+=encodeURIComponent(e)+"="+encodeURIComponent(t[e])}}return s}function X(t){let s={};let e=t.split("&");for(let t=0,i=e.length;t<i;t++){let i=e[t].split("=");s[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return s}let z=false;try{z=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){}const V=z;function J(t){const s=t.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!s||V)){return new XMLHttpRequest}}catch(t){}if(!s){try{return new(B[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}function K(){}const W=function(){const t=new J({xdomain:false});return null!=t.responseType}();class Y extends U{constructor(t){super(t);this.polling=false;if(typeof location!=="undefined"){const s="https:"===location.protocol;let e=location.port;if(!e){e=s?"443":"80"}this.xd=typeof location!=="undefined"&&t.hostname!==location.hostname||e!==t.port;this.xs=t.secure!==s}const s=t&&t.forceBase64;this.supportsBinary=W&&!s}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const s=()=>{this.readyState="paused";t()};if(this.polling||!this.writable){let t=0;if(this.polling){t++;this.once("pollComplete",(function(){--t||s()}))}if(!this.writable){t++;this.once("drain",(function(){--t||s()}))}}else{s()}}poll(){this.polling=true;this.doPoll();this.emitReserved("poll")}onData(t){const s=t=>{if("opening"===this.readyState&&t.type==="open"){this.onOpen()}if("close"===t.type){this.onClose({description:"transport closed by the server"});return false}this.onPacket(t)};A(t,this.socket.binaryType).forEach(s);if("closed"!==this.readyState){this.polling=false;this.emitReserved("pollComplete");if("open"===this.readyState){this.poll()}}}doClose(){const t=()=>{this.write([{type:"close"}])};if("open"===this.readyState){t()}else{this.once("open",t)}}write(t){this.writable=false;E(t,(t=>{this.doWrite(t,(()=>{this.writable=true;this.emitReserved("drain")}))}))}uri(){let t=this.query||{};const s=this.opts.secure?"https":"http";let e="";if(false!==this.opts.timestampRequests){t[this.opts.timestampParam]=q()}if(!this.supportsBinary&&!t.sid){t.b64=1}if(this.opts.port&&("https"===s&&Number(this.opts.port)!==443||"http"===s&&Number(this.opts.port)!==80)){e=":"+this.opts.port}const i=H(t);const n=this.opts.hostname.indexOf(":")!==-1;return s+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+e+this.opts.path+(i.length?"?"+i:"")}request(t={}){Object.assign(t,{xd:this.xd,xs:this.xs},this.opts);return new G(this.uri(),t)}doWrite(t,s){const e=this.request({method:"POST",data:t});e.on("success",s);e.on("error",((t,s)=>{this.onError("xhr post error",t,s)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this));t.on("error",((t,s)=>{this.onError("xhr poll error",t,s)}));this.pollXhr=t}}class G extends x{constructor(t,s){super();_(this,s);this.opts=s;this.method=s.method||"GET";this.uri=t;this.async=false!==s.async;this.data=undefined!==s.data?s.data:null;this.create()}create(){const t=C(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;t.xscheme=!!this.opts.xs;const s=this.xhr=new J(t);try{s.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(true);for(let t in this.opts.extraHeaders){if(this.opts.extraHeaders.hasOwnProperty(t)){s.setRequestHeader(t,this.opts.extraHeaders[t])}}}}catch(t){}if("POST"===this.method){try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}}try{s.setRequestHeader("Accept","*/*")}catch(t){}if("withCredentials"in s){s.withCredentials=this.opts.withCredentials}if(this.opts.requestTimeout){s.timeout=this.opts.requestTimeout}s.onreadystatechange=()=>{if(4!==s.readyState)return;if(200===s.status||1223===s.status){this.onLoad()}else{this.setTimeoutFn((()=>{this.onError(typeof s.status==="number"?s.status:0)}),0)}};s.send(this.data)}catch(t){this.setTimeoutFn((()=>{this.onError(t)}),0);return}if(typeof document!=="undefined"){this.index=G.requestsCount++;G.requests[this.index]=this}}onError(t){this.emitReserved("error",t,this.xhr);this.cleanup(true)}cleanup(t){if("undefined"===typeof this.xhr||null===this.xhr){return}this.xhr.onreadystatechange=K;if(t){try{this.xhr.abort()}catch(t){}}if(typeof document!=="undefined"){delete G.requests[this.index]}this.xhr=null}onLoad(){const t=this.xhr.responseText;if(t!==null){this.emitReserved("data",t);this.emitReserved("success");this.cleanup()}}abort(){this.cleanup()}}G.requestsCount=0;G.requests={};if(typeof document!=="undefined"){if(typeof attachEvent==="function"){attachEvent("onunload",Q)}else if(typeof addEventListener==="function"){const t="onpagehide"in B?"pagehide":"unload";addEventListener(t,Q,false)}}function Q(){for(let t in G.requests){if(G.requests.hasOwnProperty(t)){G.requests[t].abort()}}}const Z=(()=>{const t=typeof Promise==="function"&&typeof Promise.resolve==="function";if(t){return t=>Promise.resolve().then(t)}else{return(t,s)=>s(t,0)}})();const tt=B.WebSocket||B.MozWebSocket;const st="arraybuffer";const et=typeof navigator!=="undefined"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";class it extends U{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check()){return}const t=this.uri();const s=this.opts.protocols;const e=et?{}:C(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");if(this.opts.extraHeaders){e.headers=this.opts.extraHeaders}try{this.ws=!et?s?new tt(t,s):new tt(t):new tt(t,s,e)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||st;this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{if(this.opts.autoUnref){this.ws._socket.unref()}this.onOpen()};this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t});this.ws.onmessage=t=>this.onData(t.data);this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=false;for(let s=0;s<t.length;s++){const e=t[s];const i=s===t.length-1;l(e,this.supportsBinary,(t=>{try{{this.ws.send(t)}}catch(t){}if(i){Z((()=>{this.writable=true;this.emitReserved("drain")}),this.setTimeoutFn)}}))}}doClose(){if(typeof this.ws!=="undefined"){this.ws.close();this.ws=null}}uri(){let t=this.query||{};const s=this.opts.secure?"wss":"ws";let e="";if(this.opts.port&&("wss"===s&&Number(this.opts.port)!==443||"ws"===s&&Number(this.opts.port)!==80)){e=":"+this.opts.port}if(this.opts.timestampRequests){t[this.opts.timestampParam]=q()}if(!this.supportsBinary){t.b64=1}const i=H(t);const n=this.opts.hostname.indexOf(":")!==-1;return s+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+e+this.opts.path+(i.length?"?"+i:"")}check(){return!!tt}}const nt={websocket:it,polling:Y};const rt=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;const ot=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ht(t){const s=t,e=t.indexOf("["),i=t.indexOf("]");if(e!=-1&&i!=-1){t=t.substring(0,e)+t.substring(e,i).replace(/:/g,";")+t.substring(i,t.length)}let n=rt.exec(t||""),r={},o=14;while(o--){r[ot[o]]=n[o]||""}if(e!=-1&&i!=-1){r.source=s;r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":");r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":");r.ipv6uri=true}r.pathNames=ct(r,r["path"]);r.queryKey=ft(r,r["query"]);return r}function ct(t,s){const e=/\/{2,9}/g,i=s.replace(e,"/").split("/");if(s.substr(0,1)=="/"||s.length===0){i.splice(0,1)}if(s.substr(s.length-1,1)=="/"){i.splice(i.length-1,1)}return i}function ft(t,s){const e={};s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,s,i){if(s){e[s]=i}}));return e}class at extends x{constructor(t,s={}){super();if(t&&"object"===typeof t){s=t;t=null}if(t){t=ht(t);s.hostname=t.host;s.secure=t.protocol==="https"||t.protocol==="wss";s.port=t.port;if(t.query)s.query=t.query}else if(s.host){s.hostname=ht(s.host).host}_(this,s);this.secure=null!=s.secure?s.secure:typeof location!=="undefined"&&"https:"===location.protocol;if(s.hostname&&!s.port){s.port=this.secure?"443":"80"}this.hostname=s.hostname||(typeof location!=="undefined"?location.hostname:"localhost");this.port=s.port||(typeof location!=="undefined"&&location.port?location.port:this.secure?"443":"80");this.transports=s.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.opts=Object.assign({path:"/engine.io",agent:false,withCredentials:false,upgrade:true,timestampParam:"t",rememberUpgrade:false,rejectUnauthorized:true,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:true},s);this.opts.path=this.opts.path.replace(/\/$/,"")+"/";if(typeof this.opts.query==="string"){this.opts.query=X(this.opts.query)}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingTimeoutTimer=null;if(typeof addEventListener==="function"){if(this.opts.closeOnBeforeunload){addEventListener("beforeunload",(()=>{if(this.transport){this.transport.removeAllListeners();this.transport.close()}}),false)}if(this.hostname!=="localhost"){this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})};addEventListener("offline",this.offlineEventListener,false)}}this.open()}createTransport(t){const s=Object.assign({},this.opts.query);s.EIO=O;s.transport=t;if(this.id)s.sid=this.id;const e=Object.assign({},this.opts.transportOptions[t],this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new nt[t](e)}open(){let t;if(this.opts.rememberUpgrade&&at.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){t="websocket"}else if(0===this.transports.length){this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);return}else{t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){this.transports.shift();this.open();return}t.open();this.setTransport(t)}setTransport(t){if(this.transport){this.transport.removeAllListeners()}this.transport=t;t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let s=this.createTransport(t);let e=false;at.priorWebsocketSuccess=false;const i=()=>{if(e)return;s.send([{type:"ping",data:"probe"}]);s.once("packet",(t=>{if(e)return;if("pong"===t.type&&"probe"===t.data){this.upgrading=true;this.emitReserved("upgrading",s);if(!s)return;at.priorWebsocketSuccess="websocket"===s.name;this.transport.pause((()=>{if(e)return;if("closed"===this.readyState)return;f();this.setTransport(s);s.send([{type:"upgrade"}]);this.emitReserved("upgrade",s);s=null;this.upgrading=false;this.flush()}))}else{const t=new Error("probe error");t.transport=s.name;this.emitReserved("upgradeError",t)}}))};function n(){if(e)return;e=true;f();s.close();s=null}const r=t=>{const e=new Error("probe error: "+t);e.transport=s.name;n();this.emitReserved("upgradeError",e)};function o(){r("transport closed")}function h(){r("socket closed")}function c(t){if(s&&t.name!==s.name){n()}}const f=()=>{s.removeListener("open",i);s.removeListener("error",r);s.removeListener("close",o);this.off("close",h);this.off("upgrading",c)};s.once("open",i);s.once("error",r);s.once("close",o);this.once("close",h);this.once("upgrading",c);s.open()}onOpen(){this.readyState="open";at.priorWebsocketSuccess="websocket"===this.transport.name;this.emitReserved("open");this.flush();if("open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const s=this.upgrades.length;for(;t<s;t++){this.probe(this.upgrades[t])}}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.emitReserved("packet",t);this.emitReserved("heartbeat");switch(t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout();this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case"error":const s=new Error("server error");s.code=t.data;this.onError(s);break;case"message":this.emitReserved("data",t.data);this.emitReserved("message",t.data);break}}}onHandshake(t){this.emitReserved("handshake",t);this.id=t.sid;this.transport.query.sid=t.sid;this.upgrades=this.filterUpgrades(t.upgrades);this.pingInterval=t.pingInterval;this.pingTimeout=t.pingTimeout;this.maxPayload=t.maxPayload;this.onOpen();if("closed"===this.readyState)return;this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout);if(this.opts.autoUnref){this.pingTimeoutTimer.unref()}}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emitReserved("drain")}else{this.flush()}}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t);this.prevBufferLen=t.length;this.emitReserved("flush")}}getWritablePackets(){const t=this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1;if(!t){return this.writeBuffer}let s=1;for(let t=0;t<this.writeBuffer.length;t++){const e=this.writeBuffer[t].data;if(e){s+=M(e)}if(t>0&&s>this.maxPayload){return this.writeBuffer.slice(0,t)}s+=2}return this.writeBuffer}write(t,s,e){this.sendPacket("message",t,s,e);return this}send(t,s,e){this.sendPacket("message",t,s,e);return this}sendPacket(t,s,e,i){if("function"===typeof s){i=s;s=undefined}if("function"===typeof e){i=e;e=null}if("closing"===this.readyState||"closed"===this.readyState){return}e=e||{};e.compress=false!==e.compress;const n={type:t,data:s,options:e};this.emitReserved("packetCreate",n);this.writeBuffer.push(n);if(i)this.once("flush",i);this.flush()}close(){const t=()=>{this.onClose("forced close");this.transport.close()};const s=()=>{this.off("upgrade",s);this.off("upgradeError",s);t()};const e=()=>{this.once("upgrade",s);this.once("upgradeError",s)};if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";if(this.writeBuffer.length){this.once("drain",(()=>{if(this.upgrading){e()}else{t()}}))}else if(this.upgrading){e()}else{t()}}return this}onError(t){at.priorWebsocketSuccess=false;this.emitReserved("error",t);this.onClose("transport error",t)}onClose(t,s){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){this.clearTimeoutFn(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();if(typeof removeEventListener==="function"){removeEventListener("offline",this.offlineEventListener,false)}this.readyState="closed";this.id=null;this.emitReserved("close",t,s);this.writeBuffer=[];this.prevBufferLen=0}}filterUpgrades(t){const s=[];let e=0;const i=t.length;for(;e<i;e++){if(~this.transports.indexOf(t[e]))s.push(t[e])}return s}}at.protocol=O;function ut(t,s="",e){let i=t;e=e||typeof location!=="undefined"&&location;if(null==t)t=e.protocol+"//"+e.host;if(typeof t==="string"){if("/"===t.charAt(0)){if("/"===t.charAt(1)){t=e.protocol+t}else{t=e.host+t}}if(!/^(https?|wss?):\/\//.test(t)){if("undefined"!==typeof e){t=e.protocol+"//"+t}else{t="https://"+t}}i=ht(t)}if(!i.port){if(/^(http|ws)$/.test(i.protocol)){i.port="80"}else if(/^(http|ws)s$/.test(i.protocol)){i.port="443"}}i.path=i.path||"/";const n=i.host.indexOf(":")!==-1;const r=n?"["+i.host+"]":i.host;i.id=i.protocol+"://"+r+":"+i.port+s;i.href=i.protocol+"://"+r+(e&&e.port===i.port?"":":"+i.port);return i}const lt=typeof ArrayBuffer==="function";const dt=t=>typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer;const pt=Object.prototype.toString;const yt=typeof Blob==="function"||typeof Blob!=="undefined"&&pt.call(Blob)==="[object BlobConstructor]";const gt=typeof File==="function"||typeof File!=="undefined"&&pt.call(File)==="[object FileConstructor]";function bt(t){return lt&&(t instanceof ArrayBuffer||dt(t))||yt&&t instanceof Blob||gt&&t instanceof File}function wt(t,s){if(!t||typeof t!=="object"){return false}if(Array.isArray(t)){for(let s=0,e=t.length;s<e;s++){if(wt(t[s])){return true}}return false}if(bt(t)){return true}if(t.toJSON&&typeof t.toJSON==="function"&&arguments.length===1){return wt(t.toJSON(),true)}for(const s in t){if(Object.prototype.hasOwnProperty.call(t,s)&&wt(t[s])){return true}}return false}function mt(t){const s=[];const e=t.data;const i=t;i.data=kt(e,s);i.attachments=s.length;return{packet:i,buffers:s}}function kt(t,s){if(!t)return t;if(bt(t)){const e={_placeholder:true,num:s.length};s.push(t);return e}else if(Array.isArray(t)){const e=new Array(t.length);for(let i=0;i<t.length;i++){e[i]=kt(t[i],s)}return e}else if(typeof t==="object"&&!(t instanceof Date)){const e={};for(const i in t){if(Object.prototype.hasOwnProperty.call(t,i)){e[i]=kt(t[i],s)}}return e}return t}function vt(t,s){t.data=Et(t.data,s);t.attachments=undefined;return t}function Et(t,s){if(!t)return t;if(t&&t._placeholder===true){const e=typeof t.num==="number"&&t.num>=0&&t.num<s.length;if(e){return s[t.num]}else{throw new Error("illegal attachments")}}else if(Array.isArray(t)){for(let e=0;e<t.length;e++){t[e]=Et(t[e],s)}}else if(typeof t==="object"){for(const e in t){if(Object.prototype.hasOwnProperty.call(t,e)){t[e]=Et(t[e],s)}}}return t}const At=5;var Ot;(function(t){t[t["CONNECT"]=0]="CONNECT";t[t["DISCONNECT"]=1]="DISCONNECT";t[t["EVENT"]=2]="EVENT";t[t["ACK"]=3]="ACK";t[t["CONNECT_ERROR"]=4]="CONNECT_ERROR";t[t["BINARY_EVENT"]=5]="BINARY_EVENT";t[t["BINARY_ACK"]=6]="BINARY_ACK"})(Ot||(Ot={}));class xt{constructor(t){this.replacer=t}encode(t){if(t.type===Ot.EVENT||t.type===Ot.ACK){if(wt(t)){t.type=t.type===Ot.EVENT?Ot.BINARY_EVENT:Ot.BINARY_ACK;return this.encodeAsBinary(t)}}return[this.encodeAsString(t)]}encodeAsString(t){let s=""+t.type;if(t.type===Ot.BINARY_EVENT||t.type===Ot.BINARY_ACK){s+=t.attachments+"-"}if(t.nsp&&"/"!==t.nsp){s+=t.nsp+","}if(null!=t.id){s+=t.id}if(null!=t.data){s+=JSON.stringify(t.data,this.replacer)}return s}encodeAsBinary(t){const s=mt(t);const e=this.encodeAsString(s.packet);const i=s.buffers;i.unshift(e);return i}}class jt extends x{constructor(t){super();this.reviver=t}add(t){let s;if(typeof t==="string"){if(this.reconstructor){throw new Error("got plaintext data when reconstructing a packet")}s=this.decodeString(t);if(s.type===Ot.BINARY_EVENT||s.type===Ot.BINARY_ACK){this.reconstructor=new Bt(s);if(s.attachments===0){super.emitReserved("decoded",s)}}else{super.emitReserved("decoded",s)}}else if(bt(t)||t.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{s=this.reconstructor.takeBinaryData(t);if(s){this.reconstructor=null;super.emitReserved("decoded",s)}}}else{throw new Error("Unknown type: "+t)}}decodeString(t){let s=0;const e={type:Number(t.charAt(0))};if(Ot[e.type]===undefined){throw new Error("unknown packet type "+e.type)}if(e.type===Ot.BINARY_EVENT||e.type===Ot.BINARY_ACK){const i=s+1;while(t.charAt(++s)!=="-"&&s!=t.length){}const n=t.substring(i,s);if(n!=Number(n)||t.charAt(s)!=="-"){throw new Error("Illegal attachments")}e.attachments=Number(n)}if("/"===t.charAt(s+1)){const i=s+1;while(++s){const e=t.charAt(s);if(","===e)break;if(s===t.length)break}e.nsp=t.substring(i,s)}else{e.nsp="/"}const i=t.charAt(s+1);if(""!==i&&Number(i)==i){const i=s+1;while(++s){const e=t.charAt(s);if(null==e||Number(e)!=e){--s;break}if(s===t.length)break}e.id=Number(t.substring(i,s+1))}if(t.charAt(++s)){const i=this.tryParse(t.substr(s));if(jt.isPayloadValid(e.type,i)){e.data=i}else{throw new Error("invalid payload")}}return e}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return false}}static isPayloadValid(t,s){switch(t){case Ot.CONNECT:return typeof s==="object";case Ot.DISCONNECT:return s===undefined;case Ot.CONNECT_ERROR:return typeof s==="string"||typeof s==="object";case Ot.EVENT:case Ot.BINARY_EVENT:return Array.isArray(s)&&s.length>0;case Ot.ACK:case Ot.BINARY_ACK:return Array.isArray(s)}}destroy(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}}}class Bt{constructor(t){this.packet=t;this.buffers=[];this.reconPack=t}takeBinaryData(t){this.buffers.push(t);if(this.buffers.length===this.reconPack.attachments){const t=vt(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null}finishedReconstruction(){this.reconPack=null;this.buffers=[]}}const Ct=Object.freeze({__proto__:null,protocol:At,get PacketType(){return Ot},Encoder:xt,Decoder:jt});function Nt(t,s,e){t.on(s,e);return function i(){t.off(s,e)}}const Tt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class _t extends x{constructor(t,s,e){super();this.connected=false;this.receiveBuffer=[];this.sendBuffer=[];this.ids=0;this.acks={};this.flags={};this.io=t;this.nsp=s;if(e&&e.auth){this.auth=e.auth}if(this.io._autoConnect)this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Nt(t,"open",this.onopen.bind(this)),Nt(t,"packet",this.onpacket.bind(this)),Nt(t,"error",this.onerror.bind(this)),Nt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){if(this.connected)return this;this.subEvents();if(!this.io["_reconnecting"])this.io.open();if("open"===this.io._readyState)this.onopen();return this}open(){return this.connect()}send(...t){t.unshift("message");this.emit.apply(this,t);return this}emit(t,...s){if(Tt.hasOwnProperty(t)){throw new Error('"'+t+'" is a reserved event name')}s.unshift(t);const e={type:Ot.EVENT,data:s};e.options={};e.options.compress=this.flags.compress!==false;if("function"===typeof s[s.length-1]){const t=this.ids++;const i=s.pop();this._registerAckCallback(t,i);e.id=t}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;const n=this.flags.volatile&&(!i||!this.connected);if(n);else if(this.connected){this.notifyOutgoingListeners(e);this.packet(e)}else{this.sendBuffer.push(e)}this.flags={};return this}_registerAckCallback(t,s){const e=this.flags.timeout;if(e===undefined){this.acks[t]=s;return}const i=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let s=0;s<this.sendBuffer.length;s++){if(this.sendBuffer[s].id===t){this.sendBuffer.splice(s,1)}}s.call(this,new Error("operation has timed out"))}),e);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(i);s.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp;this.io._packet(t)}onopen(){if(typeof this.auth=="function"){this.auth((t=>{this.packet({type:Ot.CONNECT,data:t})}))}else{this.packet({type:Ot.CONNECT,data:this.auth})}}onerror(t){if(!this.connected){this.emitReserved("connect_error",t)}}onclose(t,s){this.connected=false;delete this.id;this.emitReserved("disconnect",t,s)}onpacket(t){const s=t.nsp===this.nsp;if(!s)return;switch(t.type){case Ot.CONNECT:if(t.data&&t.data.sid){const s=t.data.sid;this.onconnect(s)}else{this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"))}break;case Ot.EVENT:case Ot.BINARY_EVENT:this.onevent(t);break;case Ot.ACK:case Ot.BINARY_ACK:this.onack(t);break;case Ot.DISCONNECT:this.ondisconnect();break;case Ot.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data;this.emitReserved("connect_error",s);break}}onevent(t){const s=t.data||[];if(null!=t.id){s.push(this.ack(t.id))}if(this.connected){this.emitEvent(s)}else{this.receiveBuffer.push(Object.freeze(s))}}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const e of s){e.apply(this,t)}}super.emit.apply(this,t)}ack(t){const s=this;let e=false;return function(...i){if(e)return;e=true;s.packet({type:Ot.ACK,id:t,data:i})}}onack(t){const s=this.acks[t.id];if("function"===typeof s){s.apply(this,t.data);delete this.acks[t.id]}}onconnect(t){this.id=t;this.connected=true;this.emitBuffered();this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t)));this.receiveBuffer=[];this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t);this.packet(t)}));this.sendBuffer=[]}ondisconnect(){this.destroy();this.onclose("io server disconnect")}destroy(){if(this.subs){this.subs.forEach((t=>t()));this.subs=undefined}this.io["_destroy"](this)}disconnect(){if(this.connected){this.packet({type:Ot.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this}close(){return this.disconnect()}compress(t){this.flags.compress=t;return this}get volatile(){this.flags.volatile=true;return this}timeout(t){this.flags.timeout=t;return this}onAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.push(t);return this}prependAny(t){this._anyListeners=this._anyListeners||[];this._anyListeners.unshift(t);return this}offAny(t){if(!this._anyListeners){return this}if(t){const s=this._anyListeners;for(let e=0;e<s.length;e++){if(t===s[e]){s.splice(e,1);return this}}}else{this._anyListeners=[]}return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.push(t);return this}prependAnyOutgoing(t){this._anyOutgoingListeners=this._anyOutgoingListeners||[];this._anyOutgoingListeners.unshift(t);return this}offAnyOutgoing(t){if(!this._anyOutgoingListeners){return this}if(t){const s=this._anyOutgoingListeners;for(let e=0;e<s.length;e++){if(t===s[e]){s.splice(e,1);return this}}}else{this._anyOutgoingListeners=[]}return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const e of s){e.apply(this,t.data)}}}}function Lt(t){t=t||{};this.ms=t.min||100;this.max=t.max||1e4;this.factor=t.factor||2;this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0;this.attempts=0}Lt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random();var e=Math.floor(s*this.jitter*t);t=(Math.floor(s*10)&1)==0?t-e:t+e}return Math.min(t,this.max)|0};Lt.prototype.reset=function(){this.attempts=0};Lt.prototype.setMin=function(t){this.ms=t};Lt.prototype.setMax=function(t){this.max=t};Lt.prototype.setJitter=function(t){this.jitter=t};class Mt extends x{constructor(t,s){var e;super();this.nsps={};this.subs=[];if(t&&"object"===typeof t){s=t;t=undefined}s=s||{};s.path=s.path||"/socket.io";this.opts=s;_(this,s);this.reconnection(s.reconnection!==false);this.reconnectionAttempts(s.reconnectionAttempts||Infinity);this.reconnectionDelay(s.reconnectionDelay||1e3);this.reconnectionDelayMax(s.reconnectionDelayMax||5e3);this.randomizationFactor((e=s.randomizationFactor)!==null&&e!==void 0?e:.5);this.backoff=new Lt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==s.timeout?2e4:s.timeout);this._readyState="closed";this.uri=t;const i=s.parser||Ct;this.encoder=new i.Encoder;this.decoder=new i.Decoder;this._autoConnect=s.autoConnect!==false;if(this._autoConnect)this.open()}reconnection(t){if(!arguments.length)return this._reconnection;this._reconnection=!!t;return this}reconnectionAttempts(t){if(t===undefined)return this._reconnectionAttempts;this._reconnectionAttempts=t;return this}reconnectionDelay(t){var s;if(t===undefined)return this._reconnectionDelay;this._reconnectionDelay=t;(s=this.backoff)===null||s===void 0?void 0:s.setMin(t);return this}randomizationFactor(t){var s;if(t===undefined)return this._randomizationFactor;this._randomizationFactor=t;(s=this.backoff)===null||s===void 0?void 0:s.setJitter(t);return this}reconnectionDelayMax(t){var s;if(t===undefined)return this._reconnectionDelayMax;this._reconnectionDelayMax=t;(s=this.backoff)===null||s===void 0?void 0:s.setMax(t);return this}timeout(t){if(!arguments.length)return this._timeout;this._timeout=t;return this}maybeReconnectOnOpen(){if(!this._reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new at(this.uri,this.opts);const s=this.engine;const e=this;this._readyState="opening";this.skipReconnect=false;const i=Nt(s,"open",(function(){e.onopen();t&&t()}));const n=Nt(s,"error",(s=>{e.cleanup();e._readyState="closed";this.emitReserved("error",s);if(t){t(s)}else{e.maybeReconnectOnOpen()}}));if(false!==this._timeout){const t=this._timeout;if(t===0){i()}const e=this.setTimeoutFn((()=>{i();s.close();s.emit("error",new Error("timeout"))}),t);if(this.opts.autoUnref){e.unref()}this.subs.push((function t(){clearTimeout(e)}))}this.subs.push(i);this.subs.push(n);return this}connect(t){return this.open(t)}onopen(){this.cleanup();this._readyState="open";this.emitReserved("open");const t=this.engine;this.subs.push(Nt(t,"ping",this.onping.bind(this)),Nt(t,"data",this.ondata.bind(this)),Nt(t,"error",this.onerror.bind(this)),Nt(t,"close",this.onclose.bind(this)),Nt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,s){let e=this.nsps[t];if(!e){e=new _t(this,t,s);this.nsps[t]=e}return e}_destroy(t){const s=Object.keys(this.nsps);for(const t of s){const s=this.nsps[t];if(s.active){return}}this._close()}_packet(t){const s=this.encoder.encode(t);for(let e=0;e<s.length;e++){this.engine.write(s[e],t.options)}}cleanup(){this.subs.forEach((t=>t()));this.subs.length=0;this.decoder.destroy()}_close(){this.skipReconnect=true;this._reconnecting=false;this.onclose("forced close");if(this.engine)this.engine.close()}disconnect(){return this._close()}onclose(t,s){this.cleanup();this.backoff.reset();this._readyState="closed";this.emitReserved("close",t,s);if(this._reconnection&&!this.skipReconnect){this.reconnect()}}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts){this.backoff.reset();this.emitReserved("reconnect_failed");this._reconnecting=false}else{const s=this.backoff.duration();this._reconnecting=true;const e=this.setTimeoutFn((()=>{if(t.skipReconnect)return;this.emitReserved("reconnect_attempt",t.backoff.attempts);if(t.skipReconnect)return;t.open((s=>{if(s){t._reconnecting=false;t.reconnect();this.emitReserved("reconnect_error",s)}else{t.onreconnect()}}))}),s);if(this.opts.autoUnref){e.unref()}this.subs.push((function t(){clearTimeout(e)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=false;this.backoff.reset();this.emitReserved("reconnect",t)}}const Pt={};function Rt(t,s){if(typeof t==="object"){s=t;t=undefined}s=s||{};const e=ut(t,s.path||"/socket.io");const i=e.source;const n=e.id;const r=e.path;const o=Pt[n]&&r in Pt[n]["nsps"];const h=s.forceNew||s["force new connection"]||false===s.multiplex||o;let c;if(h){c=new Mt(i,s)}else{if(!Pt[n]){Pt[n]=new Mt(i,s)}c=Pt[n]}if(e.query&&!s.query){s.query=e.queryKey}return c.socket(e.path,s)}Object.assign(Rt,{Manager:Mt,Socket:_t,io:Rt,connect:Rt});const Ut=":host{display:block}codenames-board{width:800px}";const Dt=class{constructor(s){t(this,s)}async connectedCallback(){const t=Rt("http://localhost:8000");t.on("updateBoard",(t=>{this.boardData=t}))}render(){return s(e,null,s("codenames-board",{boardData:this.boardData}))}};Dt.style=Ut;const It=":host{display:flex;margin:50px;flex-wrap:wrap;justify-content:space-between;height:600px}";const St=class{constructor(s){t(this,s)}render(){var t,i;return s(e,null,(i=(t=this.boardData)===null||t===void 0?void 0:t.map((t=>s("codenames-cell",{word:t.word,color:t.color,mode:t.mode,revealed:t.revealed}))))!==null&&i!==void 0?i:null)}};St.style=It;const $t=":host{width:18%;height:17%}div{display:flex;justify-content:center;align-items:center;text-align:center;width:100%;height:100%;font-family:Roboto, verdana, sans-serif;font-size:15pt;background:#e8e8e8;cursor:pointer}div.revealed,div.spymaster,div.endgame{cursor:default}.blue.spymaster{color:#4183cc;font-weight:bold}.blue.revealed{background:#4183cc;color:#ffffff}.blue.endgame{background:#a6c7ee}.red.spymaster{color:#d13030;font-weight:bold}.red.revealed{background:#d13030;color:#ffffff}.red.endgame{background:#ecabab}.gray.spymaster{color:#000000;font-weight:bold}.gray.revealed{background:#8e8e8e;color:#ffffff}.black.spymaster{background:#999999;outline:5px solid #000000;font-weight:bold}.black.revealed,.black.endgame{background:#000000;color:#ffffff;outline:0}";const Ft=class{constructor(s){t(this,s);this.revealCell=i(this,"revealCell",7);this.word="";this.color=n.Gray;this.mode=r.Normal;this.revealed=false;this.showSpinner=false;this.handleRevealCell=async()=>{if(this.mode===r.Normal&&this.revealed===false){this.showSpinner=true;this.revealCell.emit(this.index)}}}render(){return s("div",{class:`${this.color} ${this.mode} ${this.revealed?"revealed":""}`,onClick:this.handleRevealCell},this.showSpinner?s("codenames-spinner",null):s("span",null,this.word.toUpperCase()))}};Ft.style=$t;const qt=':host{display:block}.lds-dual-ring:after{content:" ";display:block;width:32px;height:32px;margin:4px;border-radius:50%;border:4px solid #000;border-color:#000 transparent #000 transparent;animation:lds-dual-ring 1.2s linear infinite}@keyframes lds-dual-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}';const Ht=class{constructor(s){t(this,s)}render(){return s(e,null,s("div",{class:"lds-dual-ring"}))}};Ht.style=qt;export{Dt as codenames_app,St as codenames_board,Ft as codenames_cell,Ht as codenames_spinner};
//# sourceMappingURL=p-4d0c4345.entry.js.map